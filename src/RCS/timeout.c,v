head	1.2;
access;
symbols;
locks; strict;
comment	@ * @;


1.2
date	2002.02.01.14.52.44;	author tjaden;	state Exp;
branches;
next	1.1;

1.1
date	2002.01.12.20.16.35;	author tjaden;	state Exp;
branches;
next	;


desc
@@


1.2
log
@Updated mingw port.
@
text
@/* timeout.c
 *
 * Peter Wang <tjaden@@users.sourceforge.net>
 */


#include <unistd.h>
#include <sys/time.h>
#include "alloc.h"
#include "timeout.h"


void timeout_set (timeout_t *timeout, unsigned long msec)
{
    struct pwtimeval now;

    gettimeofday (&now, NULL);
    timeout->timeout.tv_sec = now.tv_sec + (msec / 1000);
    timeout->timeout.tv_usec = now.tv_usec + ((msec % 1000) * 1000);
}


int timeout_test (timeout_t *timeout)
{
    struct pwtimeval now;

    gettimeofday (&now, NULL);

    return ((now.tv_sec > timeout->timeout.tv_sec) ||
	    ((now.tv_sec == timeout->timeout.tv_sec) &&
	     (now.tv_usec > timeout->timeout.tv_usec)));
}
@


1.1
log
@Initial revision
@
text
@d15 1
a15 1
    struct timeval now;
d25 1
a25 1
    struct timeval now;
@
